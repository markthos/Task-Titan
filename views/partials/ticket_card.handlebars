{{!-- INDIVIDUAL TICKETS --}}


{{!-- TODO: Needs to be able to be commented on --}}

<ul class="collapsible ticket dragthing" data-id="{{id}}">
    <li>
        {{#unless is_editing}}
        {{!-- TICKET HEADER --}}
        <div class="collapsible-header">
            {{#if new_item}}
                <i class="material-icons">new_releases</i>
            {{else}}
                <i class="material-icons">subject</i>
            {{/if}}

            {{title}}
        </div>
        {{!-- TICKET CONTENT --}}
        <div class="collapsible-body">
            <a class='dropdown-trigger btn' href='#' data-target='dropdown1'>Status</a>

            <!-- Dropdown Structure -->
            <ul id='dropdown1' class='dropdown-content'>
                
                <li><a id="todo" data-id="{{id}}">To Do</a></li>
                <li><a id="doing" data-id="{{id}}">In Progress</a></li>
                <li><a id="review" data-id="{{id}}">Review</a></li>
                <li><a id="done" data-id="{{id}}">Done</a></li>
            </ul>

            <p>Posted by {{user.first_name}} on {{format_date createdAt}}</p>
            <p>Task Notes:</p>
            <p>{{ text }}</p>
             <!-- Dropdown Trigger -->
            


        {{else}}
            {{!-- EDIT TICKET --}}
            <div class="row">
                <div class="input-field col s12">
                    <input id="new_ticket_title" type="text" class="validate" value="{{title}}">
                    <label for="new_ticket_title">Ticket Title</label>
                </div>
                <div class="input-field col s12">
                    <textarea id="new_ticket_content" class="materialize-textarea">{{ text }}</textarea>
                    <label for="new_ticket_content">Ticket Content</label>
                </div>
            </div>
        {{/unless}}
        {{#if isOwner}}
            {{!-- BUTTONS SECTION --}}
            {{#unless is_editing}}
            <div class="row">
                <div class="col s6">
                    <a class="waves-effect btn-small-flat blue-text edit_button" data-action="edit" data-id="{{id}}">
                        <i class="material-icons left">edit</i>
                        Edit
                    </a>
                </div>
                <div class="col s6">
                    <a class="waves-effect btn-small-flat blue-text delete_button" data-action="delete" data-id="{{id}}">
                        <i class="material-icons left">delete</i>
                        Delete
                    </a>
                </div>
            </div>
            {{else}}
            <div class="row">
                 <div class="col s6">
                    <a class="waves-effect btn-small-flat blue-text save_button" data-action="save" data-id="{{id}}">
                        <i class="material-icons left">save</i>
                        Save
                    </a>
                 </div>
                <div class="col s6">
                    <a class="waves-effect btn-small-flat blue-text cancel_button" data-action="cancel" data-id="{{id}}">
                        <i class="material-icons left">cancel</i>
                        Cancel
                    </a>
                </div>
            </div>
            {{/unless}}
        {{/if}}
            {{!-- COMMENTS SECTION --}}
            <div class="center-align">
                <button class="comment-button btn-small" data-action="comments" data-id="{{id}}" data-state="closed">Comments</button>
            </div>
            <div id="comments_section" style="display: none; flex-direction: column">
                <ul id="comment_list" style="list-style-type: none;">
                    {{!-- COMMENTS GET INSERTED HERE VIA SCRIPT --}}
                </ul>
                <div class="center-align">
                    <button class="btn-small" id="add_comment">Add Comment +</button>
                </div>
                <div id="add_comment_display" style="display: none; flex-direction: column; align-items:center; ">
                    <textarea style="width:95%; height:50px; resize:none;" rows="20" type="textarea" id="new_comment"></textarea>
                    <div class="center-align">
                        <button class="btn-small" id="submit_new_comment" >Submit</button>
                    </div>  
                </div>
            </div>
        </div>
    </li>
</ul>
